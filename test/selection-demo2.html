<!DOCTYPE html>
<html>
<head>
	<title>selection demo2</title>
	<meta charset="utf-8">
	<style type="text/css">
		#canvas {
			position: absolute;
			top: 0;
			left: 0;
			bottom: 0;
			right: 0;
			background: lightgray;
		}	
		#desc {
			position: fixed;
			width: 100%;
			height: 30px;
			line-height: 30px;
			text-align: center;
			bottom: 30px;
			color: gray;
		}
	</style>
</head>
<body>
<div id="canvas"></div>
<div id="desc">
	点击任意位置刷新数据
</div>
<script type="text/javascript" src="../src/d3.js"></script>
<script type="text/javascript">
function makeData() {
	var count = Math.floor(Math.random() * 40) + 20;
	var data = [];
	for(var i=0; i<count; i++) {
		data.push({
			value: Math.floor(Math.random() * 180) + 20
		})
	}
	return data;
}

var svg = d3.select('#canvas')
	.append('svg')
	.attr('width', '100%')
	.attr('height', '100%');

function render(datas) {
	var update = svg.selectAll('rect')
		.data(datas)
		.attr('fill', 'green');
	update.exit().remove();
	var enter = update.enter()
		.append('rect')
		.attr('fill', 'blue')
		.attr('width', 10);
	enter.merge(update)
		.attr('x', function(d, i) {return i*15})
		.attr('height', function(d) {return d.value;});
}

render(makeData());
document.addEventListener('click', function(e) {
	render(makeData());
})
</script>
</body>
</html>